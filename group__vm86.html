<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>UnnamedOS: VM86</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UnnamedOS
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__vm86.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">VM86<div class="ingroups"><a class="el" href="group__kernel.html">Kernel</a> &raquo; <a class="el" href="group__tasks.html">Tasks</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Virtual 8086 Mode.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for VM86:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="group__vm86.png" border="0" alt="" usemap="#group____vm86"/>
<map name="group____vm86" id="group____vm86">
<area shape="rect" id="node1" href="group__tasks.html" title="Tasks" alt="" coords="5,5,61,31"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvm86__farptr__t.html">vm86_farptr_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A real mode far pointer.  <a href="structvm86__farptr__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga4e993ebe6dcd6e2599316dae5ab3c691"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga4e993ebe6dcd6e2599316dae5ab3c691">CODE_ADDRESS</a>&#160;&#160;&#160;((void*) 0x500)</td></tr>
<tr class="memdesc:ga4e993ebe6dcd6e2599316dae5ab3c691"><td class="mdescLeft">&#160;</td><td class="mdescRight">Where the assembly code will be located.  <a href="#ga4e993ebe6dcd6e2599316dae5ab3c691">More...</a><br /></td></tr>
<tr class="separator:ga4e993ebe6dcd6e2599316dae5ab3c691"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga60c4af4c1312f53efe6425d3165f0ec7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga60c4af4c1312f53efe6425d3165f0ec7">IVT_ADDRESS</a>&#160;&#160;&#160;((void*) 0)</td></tr>
<tr class="memdesc:ga60c4af4c1312f53efe6425d3165f0ec7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The real mode IVT (= Interrupt Vector Table) lies at the start of memory.  <a href="#ga60c4af4c1312f53efe6425d3165f0ec7">More...</a><br /></td></tr>
<tr class="separator:ga60c4af4c1312f53efe6425d3165f0ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5181d23361f167a6f573a68f7d92fb20"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga5181d23361f167a6f573a68f7d92fb20"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga5181d23361f167a6f573a68f7d92fb20">OPERAND_SIZE</a>&#160;&#160;&#160;0x66</td></tr>
<tr class="memdesc:ga5181d23361f167a6f573a68f7d92fb20"><td class="mdescLeft">&#160;</td><td class="mdescRight">opcode for overriding operand size <br /></td></tr>
<tr class="separator:ga5181d23361f167a6f573a68f7d92fb20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d89de6ade81693e9da5dc829e5551ee"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga9d89de6ade81693e9da5dc829e5551ee"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga9d89de6ade81693e9da5dc829e5551ee">OPCODE_PUSHF</a>&#160;&#160;&#160;0x9C</td></tr>
<tr class="memdesc:ga9d89de6ade81693e9da5dc829e5551ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">PUSHF triggers a GPF inside VM86 mode. <br /></td></tr>
<tr class="separator:ga9d89de6ade81693e9da5dc829e5551ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7193b7287dbad891e3f5e387e7629294"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga7193b7287dbad891e3f5e387e7629294"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga7193b7287dbad891e3f5e387e7629294">OPCODE_POPF</a>&#160;&#160;&#160;0x9D</td></tr>
<tr class="memdesc:ga7193b7287dbad891e3f5e387e7629294"><td class="mdescLeft">&#160;</td><td class="mdescRight">POPF triggers a GPF inside VM86 mode. <br /></td></tr>
<tr class="separator:ga7193b7287dbad891e3f5e387e7629294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga97180bc2e3a989d38776578de4cca3d2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga97180bc2e3a989d38776578de4cca3d2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga97180bc2e3a989d38776578de4cca3d2">OPCODE_INT_3</a>&#160;&#160;&#160;0xCC</td></tr>
<tr class="memdesc:ga97180bc2e3a989d38776578de4cca3d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">INT $3 triggers a GPF inside VM86 mode. <br /></td></tr>
<tr class="separator:ga97180bc2e3a989d38776578de4cca3d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ac7435f07e0b3632a19832c430f8beb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga0ac7435f07e0b3632a19832c430f8beb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga0ac7435f07e0b3632a19832c430f8beb">OPCODE_INT</a>&#160;&#160;&#160;0xCD</td></tr>
<tr class="memdesc:ga0ac7435f07e0b3632a19832c430f8beb"><td class="mdescLeft">&#160;</td><td class="mdescRight">INT triggers a GPF inside VM86 mode. <br /></td></tr>
<tr class="separator:ga0ac7435f07e0b3632a19832c430f8beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga62605f34c2c643d9ec19dceb5a2c853e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga62605f34c2c643d9ec19dceb5a2c853e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga62605f34c2c643d9ec19dceb5a2c853e">OPCODE_IRET</a>&#160;&#160;&#160;0xCF</td></tr>
<tr class="memdesc:ga62605f34c2c643d9ec19dceb5a2c853e"><td class="mdescLeft">&#160;</td><td class="mdescRight">IRET triggers a GPF inside VM86 mode. <br /></td></tr>
<tr class="separator:ga62605f34c2c643d9ec19dceb5a2c853e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga552e9ff149f01199929e95fd20d7a97c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga552e9ff149f01199929e95fd20d7a97c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga552e9ff149f01199929e95fd20d7a97c">OPCODE_CLI</a>&#160;&#160;&#160;0xFA</td></tr>
<tr class="memdesc:ga552e9ff149f01199929e95fd20d7a97c"><td class="mdescLeft">&#160;</td><td class="mdescRight">CLI triggers a GPF inside VM86 mode. <br /></td></tr>
<tr class="separator:ga552e9ff149f01199929e95fd20d7a97c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaecef1cb7bb19598f9686d46f97d9a964"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaecef1cb7bb19598f9686d46f97d9a964"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#gaecef1cb7bb19598f9686d46f97d9a964">OPCODE_STI</a>&#160;&#160;&#160;0xFB</td></tr>
<tr class="memdesc:gaecef1cb7bb19598f9686d46f97d9a964"><td class="mdescLeft">&#160;</td><td class="mdescRight">STI triggers a GPF inside VM86 mode. <br /></td></tr>
<tr class="separator:gaecef1cb7bb19598f9686d46f97d9a964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1cee587dd7abef9ce0cf18f33127fc6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#gae1cee587dd7abef9ce0cf18f33127fc6">CASE_IN</a>(opcode,  in_func,  operand,  inc,  type)</td></tr>
<tr class="memdesc:gae1cee587dd7abef9ce0cf18f33127fc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Emulates an IN instruction.  <a href="#gae1cee587dd7abef9ce0cf18f33127fc6">More...</a><br /></td></tr>
<tr class="separator:gae1cee587dd7abef9ce0cf18f33127fc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2b4cada318e4a2988f2e1291caaa29b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga2b4cada318e4a2988f2e1291caaa29b3">CASE_OUT</a>(opcode,  out_func,  operand,  inc)</td></tr>
<tr class="memdesc:ga2b4cada318e4a2988f2e1291caaa29b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Emulates an OUT instruction.  <a href="#ga2b4cada318e4a2988f2e1291caaa29b3">More...</a><br /></td></tr>
<tr class="separator:ga2b4cada318e4a2988f2e1291caaa29b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab75514feba1665a571b32ac0ab0ca07a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structvm86__farptr__t.html">vm86_farptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#gab75514feba1665a571b32ac0ab0ca07a">vm86_get_farptr</a> (void *addr)</td></tr>
<tr class="memdesc:gab75514feba1665a571b32ac0ab0ca07a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate an address into a far pointer.  <a href="#gab75514feba1665a571b32ac0ab0ca07a">More...</a><br /></td></tr>
<tr class="separator:gab75514feba1665a571b32ac0ab0ca07a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82aed4d420a3b9125d17282a9e27f0cb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga82aed4d420a3b9125d17282a9e27f0cb">vm86_write_farptr</a> (uint16_t *segment, uint16_t *offset, <a class="el" href="structvm86__farptr__t.html">vm86_farptr_t</a> farptr)</td></tr>
<tr class="memdesc:ga82aed4d420a3b9125d17282a9e27f0cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a far pointer into another location.  <a href="#ga82aed4d420a3b9125d17282a9e27f0cb">More...</a><br /></td></tr>
<tr class="separator:ga82aed4d420a3b9125d17282a9e27f0cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9b5c1e01a54fe78df1cbcaf06565d73f"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga9b5c1e01a54fe78df1cbcaf06565d73f">vm86_get_address</a> (<a class="el" href="structvm86__farptr__t.html">vm86_farptr_t</a> farptr)</td></tr>
<tr class="memdesc:ga9b5c1e01a54fe78df1cbcaf06565d73f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate a far pointer into an address.  <a href="#ga9b5c1e01a54fe78df1cbcaf06565d73f">More...</a><br /></td></tr>
<tr class="separator:ga9b5c1e01a54fe78df1cbcaf06565d73f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc3f4bd03c6bdafbdef4df17f1b7c19d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__task.html#ga76e1a8244a19fa6fac8a746ac912d2c7">task_pid_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#gadc3f4bd03c6bdafbdef4df17f1b7c19d">vm86_create_task</a> (void *code_start, void *code_end, <a class="el" href="group__vmm.html#gadeb6d1647eeda1844a2d3596a6e72b02">page_directory_t</a> *<a class="el" href="group__vmm.html#ga541a95e3358fe27930264a7308936074">page_directory</a>, size_t kernel_stack_len, size_t user_stack_len, <a class="el" href="structisr__registers__t.html">isr_registers_t</a> *registers)</td></tr>
<tr class="memdesc:gadc3f4bd03c6bdafbdef4df17f1b7c19d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a VM86 task.  <a href="#gadc3f4bd03c6bdafbdef4df17f1b7c19d">More...</a><br /></td></tr>
<tr class="separator:gadc3f4bd03c6bdafbdef4df17f1b7c19d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gace8fed2c01cb34bf58e81e0648586e14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#gace8fed2c01cb34bf58e81e0648586e14">vm86_call_bios</a> (uint8_t interrupt, <a class="el" href="structisr__registers__t.html">isr_registers_t</a> *registers)</td></tr>
<tr class="memdesc:gace8fed2c01cb34bf58e81e0648586e14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls a BIOS interrupt.  <a href="#gace8fed2c01cb34bf58e81e0648586e14">More...</a><br /></td></tr>
<tr class="separator:gace8fed2c01cb34bf58e81e0648586e14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4d4693ff0e30f0f617d47282e7ad1c7f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga4d4693ff0e30f0f617d47282e7ad1c7f">vm86_push</a> (<a class="el" href="structcpu__state__t.html">cpu_state_t</a> *cpu, uint16_t value)</td></tr>
<tr class="memdesc:ga4d4693ff0e30f0f617d47282e7ad1c7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Emulates a PUSH instruction.  <a href="#ga4d4693ff0e30f0f617d47282e7ad1c7f">More...</a><br /></td></tr>
<tr class="separator:ga4d4693ff0e30f0f617d47282e7ad1c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e03a7c1532cfd10daa3b44cec6d17b4"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga3e03a7c1532cfd10daa3b44cec6d17b4">vm86_pop</a> (<a class="el" href="structcpu__state__t.html">cpu_state_t</a> *cpu)</td></tr>
<tr class="memdesc:ga3e03a7c1532cfd10daa3b44cec6d17b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Emulates a POP instruction.  <a href="#ga3e03a7c1532cfd10daa3b44cec6d17b4">More...</a><br /></td></tr>
<tr class="separator:ga3e03a7c1532cfd10daa3b44cec6d17b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3095919424e99ca406a3252e974b86d9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga3095919424e99ca406a3252e974b86d9">vm86_increment_eip</a> (<a class="el" href="structcpu__state__t.html">cpu_state_t</a> *cpu, size_t inc)</td></tr>
<tr class="memdesc:ga3095919424e99ca406a3252e974b86d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Emulates the completion of an instruction.  <a href="#ga3095919424e99ca406a3252e974b86d9">More...</a><br /></td></tr>
<tr class="separator:ga3095919424e99ca406a3252e974b86d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6782fcbda03f1415e656d951f764f6b6"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga6782fcbda03f1415e656d951f764f6b6">vm86_monitor</a> (<a class="el" href="structcpu__state__t.html">cpu_state_t</a> *cpu)</td></tr>
<tr class="memdesc:ga6782fcbda03f1415e656d951f764f6b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Monitors a VM86 task by emulating sensitive instructions.  <a href="#ga6782fcbda03f1415e656d951f764f6b6">More...</a><br /></td></tr>
<tr class="separator:ga6782fcbda03f1415e656d951f764f6b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf5c9879c84edccf22a667fe2672bf647"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structcpu__state__t.html">cpu_state_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#gaf5c9879c84edccf22a667fe2672bf647">vm86_handle_gpf</a> (<a class="el" href="structcpu__state__t.html">cpu_state_t</a> *cpu)</td></tr>
<tr class="memdesc:gaf5c9879c84edccf22a667fe2672bf647"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles general protection faults.  <a href="#gaf5c9879c84edccf22a667fe2672bf647">More...</a><br /></td></tr>
<tr class="separator:gaf5c9879c84edccf22a667fe2672bf647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga27b2421e58df36b74005f433a4649a54"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga27b2421e58df36b74005f433a4649a54"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga27b2421e58df36b74005f433a4649a54">vm86_init</a> ()</td></tr>
<tr class="memdesc:ga27b2421e58df36b74005f433a4649a54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes VM86 mode. <br /></td></tr>
<tr class="separator:ga27b2421e58df36b74005f433a4649a54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gae0fa6cc8d6e3e1d2447dc4cef1e643df"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae0fa6cc8d6e3e1d2447dc4cef1e643df"></a>
static <a class="el" href="structvm86__farptr__t.html">vm86_farptr_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#gae0fa6cc8d6e3e1d2447dc4cef1e643df">ivt</a> = <a class="el" href="group__vm86.html#ga60c4af4c1312f53efe6425d3165f0ec7">IVT_ADDRESS</a></td></tr>
<tr class="memdesc:gae0fa6cc8d6e3e1d2447dc4cef1e643df"><td class="mdescLeft">&#160;</td><td class="mdescRight">IVT needed to do BIOS calls. <br /></td></tr>
<tr class="separator:gae0fa6cc8d6e3e1d2447dc4cef1e643df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae6573e55beaa282285d39206a8bdb514"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae6573e55beaa282285d39206a8bdb514"></a>
const void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#gae6573e55beaa282285d39206a8bdb514">vm86_call_bios_start</a></td></tr>
<tr class="memdesc:gae6573e55beaa282285d39206a8bdb514"><td class="mdescLeft">&#160;</td><td class="mdescRight">start of the BIOS call code <br /></td></tr>
<tr class="separator:gae6573e55beaa282285d39206a8bdb514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf14f8e86efff0b32d1e81cfacca9956d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf14f8e86efff0b32d1e81cfacca9956d"></a>
const void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#gaf14f8e86efff0b32d1e81cfacca9956d">vm86_call_bios_end</a></td></tr>
<tr class="memdesc:gaf14f8e86efff0b32d1e81cfacca9956d"><td class="mdescLeft">&#160;</td><td class="mdescRight">end of the BIOS call code <br /></td></tr>
<tr class="separator:gaf14f8e86efff0b32d1e81cfacca9956d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2108f29395f4d545b372ff1a68a11bd4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2108f29395f4d545b372ff1a68a11bd4"></a>
const void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm86.html#ga2108f29395f4d545b372ff1a68a11bd4">vm86_interrupt_hook</a></td></tr>
<tr class="memdesc:ga2108f29395f4d545b372ff1a68a11bd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">location of INT in the BIOS call code <br /></td></tr>
<tr class="separator:ga2108f29395f4d545b372ff1a68a11bd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Virtual 8086 Mode. </p>
<p>The VM86 mode runs 16-bit code and calls BIOS functions. A VM86 monitor is needed to emulate sensitive instructions. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="vm86__asm_8_s_source.html">vm86_asm.S</a> </dd>
<dd>
<a href="http://wiki.osdev.org/Virtual_8086_Mode">http://wiki.osdev.org/Virtual_8086_Mode</a> </dd>
<dd>
<a href="http://www.lowlevel.eu/wiki/Virtual_8086_Mode">http://www.lowlevel.eu/wiki/Virtual_8086_Mode</a> </dd>
<dd>
<a href="http://osdev.berlios.de/v86.html">http://osdev.berlios.de/v86.html</a> </dd>
<dd>
<a href="http://www.rcollins.org/articles/pvi1/pvi1.html">http://www.rcollins.org/articles/pvi1/pvi1.html</a> </dd>
<dd>
<a href="http://lowlevel.eu/wiki/Speicherbereiche">http://lowlevel.eu/wiki/Speicherbereiche</a> </dd>
<dd>
<a href="http://www.brokenthorn.com/Resources/OSDevVid2.html">http://www.brokenthorn.com/Resources/OSDevVid2.html</a> </dd>
<dd>
<a href="http://ref.x86asm.net/coder32.html">http://ref.x86asm.net/coder32.html</a> </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gae1cee587dd7abef9ce0cf18f33127fc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CASE_IN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">opcode, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">in_func, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">operand, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">inc, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">case</span> (opcode): \</div><div class="line">        *(type*) &amp;cpu-&gt;r.eax = (in_func)(operand); \</div><div class="line">        vm86_increment_eip(cpu, (inc)); \</div><div class="line">        break;</div></div><!-- fragment -->
<p>Emulates an IN instruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">opcode</td><td>the opcode of the instruction to emulate </td></tr>
    <tr><td class="paramname">in_func</td><td>the function to call </td></tr>
    <tr><td class="paramname">operand</td><td>the input port </td></tr>
    <tr><td class="paramname">inc</td><td>the instruction length in bytes </td></tr>
    <tr><td class="paramname">type</td><td>in_func's return type </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00054">54</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga2b4cada318e4a2988f2e1291caaa29b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CASE_OUT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">opcode, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">out_func, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">operand, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">inc&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">case</span> (opcode): \</div><div class="line">        (out_func)((operand), cpu-&gt;r.eax); \</div><div class="line">        vm86_increment_eip(cpu, (inc)); \</div><div class="line">        break;</div></div><!-- fragment -->
<p>Emulates an OUT instruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">opcode</td><td>the opcode of the instruction to emulate </td></tr>
    <tr><td class="paramname">out_func</td><td>the function to call </td></tr>
    <tr><td class="paramname">operand</td><td>the output port </td></tr>
    <tr><td class="paramname">inc</td><td>the instruction length in bytes </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00067">67</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga4e993ebe6dcd6e2599316dae5ab3c691"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CODE_ADDRESS&#160;&#160;&#160;((void*) 0x500)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Where the assembly code will be located. </p>
<p>The code will be memcpy'd to this location. We set this to the beginning of conventional memory. This way only one VM86 task can be run at a time! </p>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00033">33</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga60c4af4c1312f53efe6425d3165f0ec7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IVT_ADDRESS&#160;&#160;&#160;((void*) 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The real mode IVT (= Interrupt Vector Table) lies at the start of memory. </p>
<p>One of the few occasions to dereference a null pointer ^^ </p>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00036">36</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gace8fed2c01cb34bf58e81e0648586e14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vm86_call_bios </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>interrupt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structisr__registers__t.html">isr_registers_t</a> *&#160;</td>
          <td class="paramname"><em>registers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls a BIOS interrupt. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">interrupt</td><td>the interrupt vector to call </td></tr>
    <tr><td class="paramname">registers</td><td>the parameters for the call </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00205">205</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_gace8fed2c01cb34bf58e81e0648586e14_cgraph.png" border="0" usemap="#group__vm86_gace8fed2c01cb34bf58e81e0648586e14_cgraph" alt=""/></div>
<map name="group__vm86_gace8fed2c01cb34bf58e81e0648586e14_cgraph" id="group__vm86_gace8fed2c01cb34bf58e81e0648586e14_cgraph">
<area shape="rect" id="node2" href="group__vm86.html#gadc3f4bd03c6bdafbdef4df17f1b7c19d" title="Creates a VM86 task. " alt="" coords="167,472,297,497"/>
<area shape="rect" id="node3" href="group__isr.html#ga0134a3b7354debd139c8fd0d7efc3e05" title="Enables or disables interrupts. " alt="" coords="613,235,759,260"/>
<area shape="rect" id="node5" href="group__vmm.html#ga8fa0f3af01af3d3ba544031afafa2d5f" title="Marks some page(s) as used and maps them somewhere into memory. " alt="" coords="1121,447,1206,472"/>
<area shape="rect" id="node20" href="group__vmm.html#gafe1dd6fb39c3e7a95f03828bcf01bebe" title="Maps the given page(s) into memory. " alt="" coords="1320,560,1445,585"/>
<area shape="rect" id="node30" href="group__vmm.html#ga5b75ab1673d9bebdbe2f8e07759ce75d" title="Creates an empty page directory. " alt="" coords="825,447,1015,472"/>
<area shape="rect" id="node34" href="group__vmm.html#gab011b4635615c4046c5d0afc72c5ef25" title="Loads a page directory for temporary modification. " alt="" coords="350,285,543,311"/>
<area shape="rect" id="node39" href="group__vmm.html#gabb68f35006f91ee39dc4b77eb84d29b3" title="Enables or disables domain checking. " alt="" coords="351,548,542,573"/>
<area shape="rect" id="node40" href="group__gdt.html#ga0e89291c03112255d6ebdadc0ba218e0" title="Returns a selector ready to be loaded in a segment register. " alt="" coords="387,597,507,623"/>
<area shape="rect" id="node41" href="group__vm86.html#gab75514feba1665a571b32ac0ab0ca07a" title="Translate an address into a far pointer. " alt="" coords="387,647,506,672"/>
<area shape="rect" id="node42" href="group__vmm.html#gaa4627b5873ec19276ccf28f254227c01" title="Ends a page directory modification. " alt="" coords="345,335,548,360"/>
<area shape="rect" id="node43" href="group__task.html#ga2da7550dd700390f8da02c50b9ed7557" title="Adds a new task to the task list and associates a PID. " alt="" coords="409,696,484,721"/>
<area shape="rect" id="node4" href="group__isr.html#gabeba9dfd0275f78fc2a6c2aa44b2ed52" title="Returns whether interrupts are enabled or disabled. " alt="" coords="858,5,982,31"/>
<area shape="rect" id="node6" href="group__pmm.html#gab88d4741ffdf121265ccc7a47aa06be3" title="Allocates page frames. " alt="" coords="1957,931,2042,956"/>
<area shape="rect" id="node13" href="group__vmm.html#ga94d0d5a556b0b3fe234349138fa1ba2d" title="Translates VMM into PMM flags. " alt="" coords="1308,511,1457,536"/>
<area shape="rect" id="node14" href="group__vmm.html#gac9b3b29083204cd04643f125d9cc4447" title="Finds unmapped pages. " alt="" coords="1328,335,1438,360"/>
<area shape="rect" id="node19" href="group__vmm.html#gab536804df3329c431fdf5c4486f09c23" title="Extracts a domain from the given flags. " alt="" coords="2152,399,2279,424"/>
<area shape="rect" id="node7" href="group__pmm.html#ga7fea33d2f72598f45f4e85f41534ccfa" title="Finds free page frames. " alt="" coords="2160,931,2271,956"/>
<area shape="rect" id="node10" href="group__pmm.html#ga71675c8083936fe4c7066c9eda8c5a53" title="Marks page frames for a given memory range as used or unused. " alt="" coords="2372,980,2452,1005"/>
<area shape="rect" id="node8" href="group__pmm.html#gafa8dcde21f682f3a42a163781152a68b" title="Returns a bitmap entry. " alt="" coords="2350,931,2475,956"/>
<area shape="rect" id="node9" href="group__pmm.html#gad391adf0e0bfb5312b735ee87c0c7774" title="Returns a memory address belonging to a given page. " alt="" coords="2347,703,2478,728"/>
<area shape="rect" id="node11" href="group__pmm.html#ga23e6a7808d715af89d32c53c006a4636" title="Returns to which page a given memory address belongs. " alt="" coords="2533,880,2647,905"/>
<area shape="rect" id="node12" href="group__pmm.html#ga2af94bf7238dce2d9292635e69cbc56e" title="Sets a bitmap entry to a value. " alt="" coords="2529,980,2652,1005"/>
<area shape="rect" id="node15" href="group__vmm.html#gae24357af46126c4386fa4799eb660854" title="Translates a virtual address into a physical address. " alt="" coords="1505,259,1692,284"/>
<area shape="rect" id="node16" href="group__mmu.html#gaaf33eb687179f89ce91453795e9a6884" title="Returns whether paging is enabled or disabled. " alt="" coords="1740,157,1864,183"/>
<area shape="rect" id="node17" href="group__vmm.html#gaca2ad6adc3d01b4f69741bb3063b44bb" title="Returns a virtual or physical address to a page table entry in memory. " alt="" coords="1925,563,2074,601"/>
<area shape="rect" id="node18" href="group__vmm.html#ga4ec502fa0597ddc39ccefc5e41ed7068" title="Returns a virtual or physical address to a page table in memory. " alt="" coords="2141,652,2290,677"/>
<area shape="rect" id="node21" href="group__vmm.html#ga36be7c83d887d2111b317b5ac796916f" title="Maps or unmaps the given page(s) into memory. " alt="" coords="1509,611,1688,636"/>
<area shape="rect" id="node22" href="group__vmm.html#ga408e67ff0d3c015f67a04d649a193677" title="Checks whether a virtual address might be accessed with the given flags. " alt="" coords="1928,461,2071,487"/>
<area shape="rect" id="node25" href="group__vmm.html#ga3e7053cfb721b4d0e489b95df9063ad5" title="Maps the given page into memory. " alt="" coords="1760,611,1844,636"/>
<area shape="rect" id="node27" href="group__vmm.html#ga712a6069455f36990ea8af974ba0a1e3" title="Unmaps the given page from memory. " alt="" coords="1753,703,1851,728"/>
<area shape="rect" id="node23" href="group__vmm.html#gae814d9b3e619cc1b3acaa94a336157c8" title="Returns the domain a virtual address belongs to. " alt="" coords="2135,448,2296,487"/>
<area shape="rect" id="node24" href="group__vmm.html#gaa0f722ed8ab308a12be211f1ef561143" title="Returns whether a virtual address belongs to a given domain. " alt="" coords="2344,455,2481,480"/>
<area shape="rect" id="node26" href="group__mmu.html#gad103653c8eb7655d46156dff6c76b401" title="Flushes the Translation Lookaside Buffer for the given page. " alt="" coords="1946,677,2054,703"/>
<area shape="rect" id="node28" href="group__vmm.html#ga29929b27b1ddfc99ab409bb3149df217" title="Destroys a page table in the current page directory. " alt="" coords="1912,779,2087,804"/>
<area shape="rect" id="node29" href="group__pmm.html#ga71cab475c600b07e6ae2c34af4b65843" title="Frees page frames. " alt="" coords="2175,980,2256,1005"/>
<area shape="rect" id="node31" href="group__vmm.html#ga37cd05a420e7bbc80e9df22d1d7a8661" title="If necessary, maps the given page(s) somewhere into memory. " alt="" coords="1066,335,1260,360"/>
<area shape="rect" id="node32" href="group__vmm.html#ga26bea35e9465b7d5f4cb6db78bcb3aff" title="If necessary, unmaps the given page(s) from memory. " alt="" coords="1086,384,1240,423"/>
<area shape="rect" id="node33" href="group__vmm.html#ga76fc2abe20698540ecc6ab14ac393785" title="Unmaps the given page(s) from memory. " alt="" coords="1313,461,1453,487"/>
<area shape="rect" id="node35" href="group__vmm.html#gae21ea3cbc0bddb5ade0251b4bfb2946c" title="Loads a new page directory. " alt="" coords="596,284,775,309"/>
<area shape="rect" id="node36" href="group__vmm.html#ga83a06334c1c593e06779d150d1efc082" title="Refreshes the page directory entries that are shared across page directories. " alt="" coords="823,335,1018,360"/>
<area shape="rect" id="node37" href="group__mmu.html#ga5a8c2a23e92f9d6eaa5e472c0fe9c98f" title="Loads a page directory into the CR3 register. " alt="" coords="1073,208,1253,233"/>
<area shape="rect" id="node38" href="group__mmu.html#ga3108646fd68a371f496027b8a899ea18" title="Loads a page directory and enables paging. " alt="" coords="847,183,993,208"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gadc3f4bd03c6bdafbdef4df17f1b7c19d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__task.html#ga76e1a8244a19fa6fac8a746ac912d2c7">task_pid_t</a> vm86_create_task </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>code_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>code_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__vmm.html#gadeb6d1647eeda1844a2d3596a6e72b02">page_directory_t</a> *&#160;</td>
          <td class="paramname"><em>page_directory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>kernel_stack_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>user_stack_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structisr__registers__t.html">isr_registers_t</a> *&#160;</td>
          <td class="paramname"><em>registers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a VM86 task. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__task.html#ga6889ecd06c51d1debc57ba9e0317a734" title="Creates a task. ">task_create_detailed</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">code_start</td><td>start of the 16-bit code </td></tr>
    <tr><td class="paramname">code_end</td><td>end of the 16-bit code </td></tr>
    <tr><td class="paramname">page_directory</td><td>a page directory for the task, if 0 a new one is created </td></tr>
    <tr><td class="paramname">kernel_stack_len</td><td>number of bytes to allocate for the kernel stack </td></tr>
    <tr><td class="paramname">user_stack_len</td><td>number of bytes to allocate for the user stack </td></tr>
    <tr><td class="paramname">registers</td><td>parameters to pass to the 16-bit code </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the task's PID </dd></dl>
<p>Identity maps the first MiB so our VM86 task can operate inside it. Because this is not inside the user domain (1GiB and onwards), bypasses domain checking.</p>
<p>Copies the 16-bit code into conventional memory. We could map the code as virtual memory, but copying is easier ;) Note that this code might not reference any labels or so, because it needs to be position independent. For calling the BIOS this is enough, if we started writing real 16-bit programs, we would need to improve this.</p>
<p>The user stack is located after the code (we assume that's free memory). </p>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00145">145</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_gadc3f4bd03c6bdafbdef4df17f1b7c19d_cgraph.png" border="0" usemap="#group__vm86_gadc3f4bd03c6bdafbdef4df17f1b7c19d_cgraph" alt=""/></div>
<map name="group__vm86_gadc3f4bd03c6bdafbdef4df17f1b7c19d_cgraph" id="group__vm86_gadc3f4bd03c6bdafbdef4df17f1b7c19d_cgraph">
<area shape="rect" id="node2" href="group__isr.html#ga0134a3b7354debd139c8fd0d7efc3e05" title="Enables or disables interrupts. " alt="" coords="452,235,597,260"/>
<area shape="rect" id="node4" href="group__vmm.html#ga8fa0f3af01af3d3ba544031afafa2d5f" title="Marks some page(s) as used and maps them somewhere into memory. " alt="" coords="959,447,1044,472"/>
<area shape="rect" id="node19" href="group__vmm.html#gafe1dd6fb39c3e7a95f03828bcf01bebe" title="Maps the given page(s) into memory. " alt="" coords="1159,560,1284,585"/>
<area shape="rect" id="node29" href="group__vmm.html#ga5b75ab1673d9bebdbe2f8e07759ce75d" title="Creates an empty page directory. " alt="" coords="664,447,854,472"/>
<area shape="rect" id="node33" href="group__vmm.html#gab011b4635615c4046c5d0afc72c5ef25" title="Loads a page directory for temporary modification. " alt="" coords="189,285,382,311"/>
<area shape="rect" id="node38" href="group__vmm.html#gabb68f35006f91ee39dc4b77eb84d29b3" title="Enables or disables domain checking. " alt="" coords="190,548,381,573"/>
<area shape="rect" id="node39" href="group__gdt.html#ga0e89291c03112255d6ebdadc0ba218e0" title="Returns a selector ready to be loaded in a segment register. " alt="" coords="225,597,345,623"/>
<area shape="rect" id="node40" href="group__vm86.html#gab75514feba1665a571b32ac0ab0ca07a" title="Translate an address into a far pointer. " alt="" coords="226,647,345,672"/>
<area shape="rect" id="node41" href="group__vmm.html#gaa4627b5873ec19276ccf28f254227c01" title="Ends a page directory modification. " alt="" coords="184,335,387,360"/>
<area shape="rect" id="node42" href="group__task.html#ga2da7550dd700390f8da02c50b9ed7557" title="Adds a new task to the task list and associates a PID. " alt="" coords="248,696,323,721"/>
<area shape="rect" id="node3" href="group__isr.html#gabeba9dfd0275f78fc2a6c2aa44b2ed52" title="Returns whether interrupts are enabled or disabled. " alt="" coords="697,5,821,31"/>
<area shape="rect" id="node5" href="group__pmm.html#gab88d4741ffdf121265ccc7a47aa06be3" title="Allocates page frames. " alt="" coords="1795,931,1881,956"/>
<area shape="rect" id="node12" href="group__vmm.html#ga94d0d5a556b0b3fe234349138fa1ba2d" title="Translates VMM into PMM flags. " alt="" coords="1147,511,1296,536"/>
<area shape="rect" id="node13" href="group__vmm.html#gac9b3b29083204cd04643f125d9cc4447" title="Finds unmapped pages. " alt="" coords="1167,335,1276,360"/>
<area shape="rect" id="node18" href="group__vmm.html#gab536804df3329c431fdf5c4486f09c23" title="Extracts a domain from the given flags. " alt="" coords="1991,399,2118,424"/>
<area shape="rect" id="node6" href="group__pmm.html#ga7fea33d2f72598f45f4e85f41534ccfa" title="Finds free page frames. " alt="" coords="1999,931,2110,956"/>
<area shape="rect" id="node9" href="group__pmm.html#ga71675c8083936fe4c7066c9eda8c5a53" title="Marks page frames for a given memory range as used or unused. " alt="" coords="2211,980,2291,1005"/>
<area shape="rect" id="node7" href="group__pmm.html#gafa8dcde21f682f3a42a163781152a68b" title="Returns a bitmap entry. " alt="" coords="2189,931,2313,956"/>
<area shape="rect" id="node8" href="group__pmm.html#gad391adf0e0bfb5312b735ee87c0c7774" title="Returns a memory address belonging to a given page. " alt="" coords="2185,703,2317,728"/>
<area shape="rect" id="node10" href="group__pmm.html#ga23e6a7808d715af89d32c53c006a4636" title="Returns to which page a given memory address belongs. " alt="" coords="2372,880,2486,905"/>
<area shape="rect" id="node11" href="group__pmm.html#ga2af94bf7238dce2d9292635e69cbc56e" title="Sets a bitmap entry to a value. " alt="" coords="2367,980,2491,1005"/>
<area shape="rect" id="node14" href="group__vmm.html#gae24357af46126c4386fa4799eb660854" title="Translates a virtual address into a physical address. " alt="" coords="1344,259,1531,284"/>
<area shape="rect" id="node15" href="group__mmu.html#gaaf33eb687179f89ce91453795e9a6884" title="Returns whether paging is enabled or disabled. " alt="" coords="1579,157,1703,183"/>
<area shape="rect" id="node16" href="group__vmm.html#gaca2ad6adc3d01b4f69741bb3063b44bb" title="Returns a virtual or physical address to a page table entry in memory. " alt="" coords="1764,563,1913,601"/>
<area shape="rect" id="node17" href="group__vmm.html#ga4ec502fa0597ddc39ccefc5e41ed7068" title="Returns a virtual or physical address to a page table in memory. " alt="" coords="1980,652,2129,677"/>
<area shape="rect" id="node20" href="group__vmm.html#ga36be7c83d887d2111b317b5ac796916f" title="Maps or unmaps the given page(s) into memory. " alt="" coords="1348,611,1527,636"/>
<area shape="rect" id="node21" href="group__vmm.html#ga408e67ff0d3c015f67a04d649a193677" title="Checks whether a virtual address might be accessed with the given flags. " alt="" coords="1767,461,1910,487"/>
<area shape="rect" id="node24" href="group__vmm.html#ga3e7053cfb721b4d0e489b95df9063ad5" title="Maps the given page into memory. " alt="" coords="1599,611,1683,636"/>
<area shape="rect" id="node26" href="group__vmm.html#ga712a6069455f36990ea8af974ba0a1e3" title="Unmaps the given page from memory. " alt="" coords="1592,703,1690,728"/>
<area shape="rect" id="node22" href="group__vmm.html#gae814d9b3e619cc1b3acaa94a336157c8" title="Returns the domain a virtual address belongs to. " alt="" coords="1974,448,2135,487"/>
<area shape="rect" id="node23" href="group__vmm.html#gaa0f722ed8ab308a12be211f1ef561143" title="Returns whether a virtual address belongs to a given domain. " alt="" coords="2183,455,2319,480"/>
<area shape="rect" id="node25" href="group__mmu.html#gad103653c8eb7655d46156dff6c76b401" title="Flushes the Translation Lookaside Buffer for the given page. " alt="" coords="1784,677,1892,703"/>
<area shape="rect" id="node27" href="group__vmm.html#ga29929b27b1ddfc99ab409bb3149df217" title="Destroys a page table in the current page directory. " alt="" coords="1751,779,1926,804"/>
<area shape="rect" id="node28" href="group__pmm.html#ga71cab475c600b07e6ae2c34af4b65843" title="Frees page frames. " alt="" coords="2014,980,2095,1005"/>
<area shape="rect" id="node30" href="group__vmm.html#ga37cd05a420e7bbc80e9df22d1d7a8661" title="If necessary, maps the given page(s) somewhere into memory. " alt="" coords="904,335,1099,360"/>
<area shape="rect" id="node31" href="group__vmm.html#ga26bea35e9465b7d5f4cb6db78bcb3aff" title="If necessary, unmaps the given page(s) from memory. " alt="" coords="925,384,1079,423"/>
<area shape="rect" id="node32" href="group__vmm.html#ga76fc2abe20698540ecc6ab14ac393785" title="Unmaps the given page(s) from memory. " alt="" coords="1152,461,1292,487"/>
<area shape="rect" id="node34" href="group__vmm.html#gae21ea3cbc0bddb5ade0251b4bfb2946c" title="Loads a new page directory. " alt="" coords="435,284,614,309"/>
<area shape="rect" id="node35" href="group__vmm.html#ga83a06334c1c593e06779d150d1efc082" title="Refreshes the page directory entries that are shared across page directories. " alt="" coords="662,335,856,360"/>
<area shape="rect" id="node36" href="group__mmu.html#ga5a8c2a23e92f9d6eaa5e472c0fe9c98f" title="Loads a page directory into the CR3 register. " alt="" coords="912,208,1091,233"/>
<area shape="rect" id="node37" href="group__mmu.html#ga3108646fd68a371f496027b8a899ea18" title="Loads a page directory and enables paging. " alt="" coords="686,183,832,208"/>
</map>
</div>
</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_gadc3f4bd03c6bdafbdef4df17f1b7c19d_icgraph.png" border="0" usemap="#group__vm86_gadc3f4bd03c6bdafbdef4df17f1b7c19d_icgraph" alt=""/></div>
<map name="group__vm86_gadc3f4bd03c6bdafbdef4df17f1b7c19d_icgraph" id="group__vm86_gadc3f4bd03c6bdafbdef4df17f1b7c19d_icgraph">
<area shape="rect" id="node2" href="group__vm86.html#gace8fed2c01cb34bf58e81e0648586e14" title="Calls a BIOS interrupt. " alt="" coords="184,5,297,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga9b5c1e01a54fe78df1cbcaf06565d73f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* vm86_get_address </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvm86__farptr__t.html">vm86_farptr_t</a>&#160;</td>
          <td class="paramname"><em>farptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Translate a far pointer into an address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">farptr</td><td>the far pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the address </dd></dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00129">129</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga9b5c1e01a54fe78df1cbcaf06565d73f_icgraph.png" border="0" usemap="#group__vm86_ga9b5c1e01a54fe78df1cbcaf06565d73f_icgraph" alt=""/></div>
<map name="group__vm86_ga9b5c1e01a54fe78df1cbcaf06565d73f_icgraph" id="group__vm86_ga9b5c1e01a54fe78df1cbcaf06565d73f_icgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga4d4693ff0e30f0f617d47282e7ad1c7f" title="Emulates a PUSH instruction. " alt="" coords="215,5,306,31"/>
<area shape="rect" id="node3" href="group__vm86.html#ga6782fcbda03f1415e656d951f764f6b6" title="Monitors a VM86 task by emulating sensitive instructions. " alt="" coords="381,81,487,107"/>
<area shape="rect" id="node6" href="group__vm86.html#ga3e03a7c1532cfd10daa3b44cec6d17b4" title="Emulates a POP instruction. " alt="" coords="219,107,302,132"/>
<area shape="rect" id="node7" href="group__vm86.html#ga3095919424e99ca406a3252e974b86d9" title="Emulates the completion of an instruction. " alt="" coords="188,156,333,181"/>
<area shape="rect" id="node4" href="group__vm86.html#gaf5c9879c84edccf22a667fe2672bf647" title="Handles general protection faults. " alt="" coords="535,81,662,107"/>
<area shape="rect" id="node5" href="group__vm86.html#ga27b2421e58df36b74005f433a4649a54" title="Initializes VM86 mode. " alt="" coords="710,81,789,107"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gab75514feba1665a571b32ac0ab0ca07a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structvm86__farptr__t.html">vm86_farptr_t</a> vm86_get_farptr </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Translate an address into a far pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>the address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the far pointer </dd></dl>
<p>There are many ways to translate an address into a far pointer. We do it in such a way that our code is likely to only use one segment (which is easier than handling multiple segments). The equation used is: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;paddr = segment * 16 + offset</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="vm86_8c_source.html#l00091">91</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_gab75514feba1665a571b32ac0ab0ca07a_icgraph.png" border="0" usemap="#group__vm86_gab75514feba1665a571b32ac0ab0ca07a_icgraph" alt=""/></div>
<map name="group__vm86_gab75514feba1665a571b32ac0ab0ca07a_icgraph" id="group__vm86_gab75514feba1665a571b32ac0ab0ca07a_icgraph">
<area shape="rect" id="node2" href="group__vm86.html#gadc3f4bd03c6bdafbdef4df17f1b7c19d" title="Creates a VM86 task. " alt="" coords="179,5,309,31"/>
<area shape="rect" id="node4" href="group__vm86.html#ga4d4693ff0e30f0f617d47282e7ad1c7f" title="Emulates a PUSH instruction. " alt="" coords="199,55,289,80"/>
<area shape="rect" id="node5" href="group__vm86.html#ga6782fcbda03f1415e656d951f764f6b6" title="Monitors a VM86 task by emulating sensitive instructions. " alt="" coords="369,131,474,156"/>
<area shape="rect" id="node8" href="group__vm86.html#ga3e03a7c1532cfd10daa3b44cec6d17b4" title="Emulates a POP instruction. " alt="" coords="203,156,286,181"/>
<area shape="rect" id="node9" href="group__vm86.html#ga3095919424e99ca406a3252e974b86d9" title="Emulates the completion of an instruction. " alt="" coords="172,205,317,231"/>
<area shape="rect" id="node3" href="group__vm86.html#gace8fed2c01cb34bf58e81e0648586e14" title="Calls a BIOS interrupt. " alt="" coords="365,5,478,31"/>
<area shape="rect" id="node6" href="group__vm86.html#gaf5c9879c84edccf22a667fe2672bf647" title="Handles general protection faults. " alt="" coords="526,131,653,156"/>
<area shape="rect" id="node7" href="group__vm86.html#ga27b2421e58df36b74005f433a4649a54" title="Initializes VM86 mode. " alt="" coords="701,131,780,156"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaf5c9879c84edccf22a667fe2672bf647"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structcpu__state__t.html">cpu_state_t</a>* vm86_handle_gpf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpu__state__t.html">cpu_state_t</a> *&#160;</td>
          <td class="paramname"><em>cpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles general protection faults. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cpu</td><td>the CPU state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a (possibly altered) CPU state </dd></dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00337">337</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_gaf5c9879c84edccf22a667fe2672bf647_cgraph.png" border="0" usemap="#group__vm86_gaf5c9879c84edccf22a667fe2672bf647_cgraph" alt=""/></div>
<map name="group__vm86_gaf5c9879c84edccf22a667fe2672bf647_cgraph" id="group__vm86_gaf5c9879c84edccf22a667fe2672bf647_cgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga6782fcbda03f1415e656d951f764f6b6" title="Monitors a VM86 task by emulating sensitive instructions. " alt="" coords="181,181,286,207"/>
<area shape="rect" id="node3" href="group__task.html#ga04bd7d28496d63ff2efdb213a3e5a26a" title="Returns whether a task is a VM86 task. " alt="" coords="369,5,481,31"/>
<area shape="rect" id="node5" href="group__schedule.html#ga14b9cfb952fa598db494e5cc3e7b25bf" title="Returns the current task&#39;s PID. " alt="" coords="334,55,516,80"/>
<area shape="rect" id="node6" href="group__vm86.html#ga9b5c1e01a54fe78df1cbcaf06565d73f" title="Translate a far pointer into an address. " alt="" coords="564,181,699,207"/>
<area shape="rect" id="node7" href="group__vm86.html#ga4d4693ff0e30f0f617d47282e7ad1c7f" title="Emulates a PUSH instruction. " alt="" coords="380,156,470,181"/>
<area shape="rect" id="node8" href="group__vm86.html#ga82aed4d420a3b9125d17282a9e27f0cb" title="Writes a far pointer into another location. " alt="" coords="567,244,695,269"/>
<area shape="rect" id="node9" href="group__vm86.html#gab75514feba1665a571b32ac0ab0ca07a" title="Translate an address into a far pointer. " alt="" coords="572,293,691,319"/>
<area shape="rect" id="node10" href="group__vm86.html#ga3095919424e99ca406a3252e974b86d9" title="Emulates the completion of an instruction. " alt="" coords="353,205,498,231"/>
<area shape="rect" id="node11" href="group__vm86.html#ga3e03a7c1532cfd10daa3b44cec6d17b4" title="Emulates a POP instruction. " alt="" coords="383,307,467,332"/>
<area shape="rect" id="node4" href="group__task.html#ga677ee1017fff2ed04306b4cd099e73c3" title="Returns the internal task structure associated with the given PID. " alt="" coords="595,5,667,31"/>
</map>
</div>
</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_gaf5c9879c84edccf22a667fe2672bf647_icgraph.png" border="0" usemap="#group__vm86_gaf5c9879c84edccf22a667fe2672bf647_icgraph" alt=""/></div>
<map name="group__vm86_gaf5c9879c84edccf22a667fe2672bf647_icgraph" id="group__vm86_gaf5c9879c84edccf22a667fe2672bf647_icgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga27b2421e58df36b74005f433a4649a54" title="Initializes VM86 mode. " alt="" coords="181,5,259,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga3095919424e99ca406a3252e974b86d9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void vm86_increment_eip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpu__state__t.html">cpu_state_t</a> *&#160;</td>
          <td class="paramname"><em>cpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Emulates the completion of an instruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cpu</td><td>the CPU state to modify </td></tr>
    <tr><td class="paramname">inc</td><td>the instruction length in bytes </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00249">249</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga3095919424e99ca406a3252e974b86d9_cgraph.png" border="0" usemap="#group__vm86_ga3095919424e99ca406a3252e974b86d9_cgraph" alt=""/></div>
<map name="group__vm86_ga3095919424e99ca406a3252e974b86d9_cgraph" id="group__vm86_ga3095919424e99ca406a3252e974b86d9_cgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga82aed4d420a3b9125d17282a9e27f0cb" title="Writes a far pointer into another location. " alt="" coords="202,5,330,31"/>
<area shape="rect" id="node3" href="group__vm86.html#gab75514feba1665a571b32ac0ab0ca07a" title="Translate an address into a far pointer. " alt="" coords="207,55,325,80"/>
<area shape="rect" id="node4" href="group__vm86.html#ga9b5c1e01a54fe78df1cbcaf06565d73f" title="Translate a far pointer into an address. " alt="" coords="198,104,333,129"/>
</map>
</div>
</p>

<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga3095919424e99ca406a3252e974b86d9_icgraph.png" border="0" usemap="#group__vm86_ga3095919424e99ca406a3252e974b86d9_icgraph" alt=""/></div>
<map name="group__vm86_ga3095919424e99ca406a3252e974b86d9_icgraph" id="group__vm86_ga3095919424e99ca406a3252e974b86d9_icgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga6782fcbda03f1415e656d951f764f6b6" title="Monitors a VM86 task by emulating sensitive instructions. " alt="" coords="198,5,304,31"/>
<area shape="rect" id="node3" href="group__vm86.html#gaf5c9879c84edccf22a667fe2672bf647" title="Handles general protection faults. " alt="" coords="352,5,480,31"/>
<area shape="rect" id="node4" href="group__vm86.html#ga27b2421e58df36b74005f433a4649a54" title="Initializes VM86 mode. " alt="" coords="528,5,606,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga6782fcbda03f1415e656d951f764f6b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t vm86_monitor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpu__state__t.html">cpu_state_t</a> *&#160;</td>
          <td class="paramname"><em>cpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Monitors a VM86 task by emulating sensitive instructions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cpu</td><td>the task's CPU state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether the monitor handled the GPF </dd></dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00260">260</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga6782fcbda03f1415e656d951f764f6b6_cgraph.png" border="0" usemap="#group__vm86_ga6782fcbda03f1415e656d951f764f6b6_cgraph" alt=""/></div>
<map name="group__vm86_ga6782fcbda03f1415e656d951f764f6b6_cgraph" id="group__vm86_ga6782fcbda03f1415e656d951f764f6b6_cgraph">
<area shape="rect" id="node2" href="group__task.html#ga04bd7d28496d63ff2efdb213a3e5a26a" title="Returns whether a task is a VM86 task. " alt="" coords="194,5,306,31"/>
<area shape="rect" id="node4" href="group__schedule.html#ga14b9cfb952fa598db494e5cc3e7b25bf" title="Returns the current task&#39;s PID. " alt="" coords="159,55,341,80"/>
<area shape="rect" id="node5" href="group__vm86.html#ga9b5c1e01a54fe78df1cbcaf06565d73f" title="Translate a far pointer into an address. " alt="" coords="389,181,523,207"/>
<area shape="rect" id="node6" href="group__vm86.html#ga4d4693ff0e30f0f617d47282e7ad1c7f" title="Emulates a PUSH instruction. " alt="" coords="205,156,295,181"/>
<area shape="rect" id="node7" href="group__vm86.html#ga82aed4d420a3b9125d17282a9e27f0cb" title="Writes a far pointer into another location. " alt="" coords="392,244,520,269"/>
<area shape="rect" id="node8" href="group__vm86.html#gab75514feba1665a571b32ac0ab0ca07a" title="Translate an address into a far pointer. " alt="" coords="397,293,515,319"/>
<area shape="rect" id="node9" href="group__vm86.html#ga3095919424e99ca406a3252e974b86d9" title="Emulates the completion of an instruction. " alt="" coords="177,205,322,231"/>
<area shape="rect" id="node10" href="group__vm86.html#ga3e03a7c1532cfd10daa3b44cec6d17b4" title="Emulates a POP instruction. " alt="" coords="208,307,292,332"/>
<area shape="rect" id="node3" href="group__task.html#ga677ee1017fff2ed04306b4cd099e73c3" title="Returns the internal task structure associated with the given PID. " alt="" coords="420,5,492,31"/>
</map>
</div>
</p>

<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga6782fcbda03f1415e656d951f764f6b6_icgraph.png" border="0" usemap="#group__vm86_ga6782fcbda03f1415e656d951f764f6b6_icgraph" alt=""/></div>
<map name="group__vm86_ga6782fcbda03f1415e656d951f764f6b6_icgraph" id="group__vm86_ga6782fcbda03f1415e656d951f764f6b6_icgraph">
<area shape="rect" id="node2" href="group__vm86.html#gaf5c9879c84edccf22a667fe2672bf647" title="Handles general protection faults. " alt="" coords="159,5,286,31"/>
<area shape="rect" id="node3" href="group__vm86.html#ga27b2421e58df36b74005f433a4649a54" title="Initializes VM86 mode. " alt="" coords="334,5,413,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga3e03a7c1532cfd10daa3b44cec6d17b4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t vm86_pop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpu__state__t.html">cpu_state_t</a> *&#160;</td>
          <td class="paramname"><em>cpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Emulates a POP instruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cpu</td><td>the CPU state to modify </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the popped value </dd></dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00235">235</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga3e03a7c1532cfd10daa3b44cec6d17b4_cgraph.png" border="0" usemap="#group__vm86_ga3e03a7c1532cfd10daa3b44cec6d17b4_cgraph" alt=""/></div>
<map name="group__vm86_ga3e03a7c1532cfd10daa3b44cec6d17b4_cgraph" id="group__vm86_ga3e03a7c1532cfd10daa3b44cec6d17b4_cgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga9b5c1e01a54fe78df1cbcaf06565d73f" title="Translate a far pointer into an address. " alt="" coords="137,5,272,31"/>
<area shape="rect" id="node3" href="group__vm86.html#ga82aed4d420a3b9125d17282a9e27f0cb" title="Writes a far pointer into another location. " alt="" coords="140,55,268,80"/>
<area shape="rect" id="node4" href="group__vm86.html#gab75514feba1665a571b32ac0ab0ca07a" title="Translate an address into a far pointer. " alt="" coords="145,104,264,129"/>
</map>
</div>
</p>

<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga3e03a7c1532cfd10daa3b44cec6d17b4_icgraph.png" border="0" usemap="#group__vm86_ga3e03a7c1532cfd10daa3b44cec6d17b4_icgraph" alt=""/></div>
<map name="group__vm86_ga3e03a7c1532cfd10daa3b44cec6d17b4_icgraph" id="group__vm86_ga3e03a7c1532cfd10daa3b44cec6d17b4_icgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga6782fcbda03f1415e656d951f764f6b6" title="Monitors a VM86 task by emulating sensitive instructions. " alt="" coords="137,5,243,31"/>
<area shape="rect" id="node3" href="group__vm86.html#gaf5c9879c84edccf22a667fe2672bf647" title="Handles general protection faults. " alt="" coords="291,5,418,31"/>
<area shape="rect" id="node4" href="group__vm86.html#ga27b2421e58df36b74005f433a4649a54" title="Initializes VM86 mode. " alt="" coords="466,5,544,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga4d4693ff0e30f0f617d47282e7ad1c7f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void vm86_push </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpu__state__t.html">cpu_state_t</a> *&#160;</td>
          <td class="paramname"><em>cpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Emulates a PUSH instruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cpu</td><td>the CPU state to modify </td></tr>
    <tr><td class="paramname">value</td><td>the value to push </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00222">222</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga4d4693ff0e30f0f617d47282e7ad1c7f_cgraph.png" border="0" usemap="#group__vm86_ga4d4693ff0e30f0f617d47282e7ad1c7f_cgraph" alt=""/></div>
<map name="group__vm86_ga4d4693ff0e30f0f617d47282e7ad1c7f_cgraph" id="group__vm86_ga4d4693ff0e30f0f617d47282e7ad1c7f_cgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga9b5c1e01a54fe78df1cbcaf06565d73f" title="Translate a far pointer into an address. " alt="" coords="144,5,278,31"/>
<area shape="rect" id="node3" href="group__vm86.html#ga82aed4d420a3b9125d17282a9e27f0cb" title="Writes a far pointer into another location. " alt="" coords="147,55,275,80"/>
<area shape="rect" id="node4" href="group__vm86.html#gab75514feba1665a571b32ac0ab0ca07a" title="Translate an address into a far pointer. " alt="" coords="152,104,270,129"/>
</map>
</div>
</p>

<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga4d4693ff0e30f0f617d47282e7ad1c7f_icgraph.png" border="0" usemap="#group__vm86_ga4d4693ff0e30f0f617d47282e7ad1c7f_icgraph" alt=""/></div>
<map name="group__vm86_ga4d4693ff0e30f0f617d47282e7ad1c7f_icgraph" id="group__vm86_ga4d4693ff0e30f0f617d47282e7ad1c7f_icgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga6782fcbda03f1415e656d951f764f6b6" title="Monitors a VM86 task by emulating sensitive instructions. " alt="" coords="144,5,249,31"/>
<area shape="rect" id="node3" href="group__vm86.html#gaf5c9879c84edccf22a667fe2672bf647" title="Handles general protection faults. " alt="" coords="297,5,425,31"/>
<area shape="rect" id="node4" href="group__vm86.html#ga27b2421e58df36b74005f433a4649a54" title="Initializes VM86 mode. " alt="" coords="473,5,551,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga82aed4d420a3b9125d17282a9e27f0cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void vm86_write_farptr </td>
          <td>(</td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvm86__farptr__t.html">vm86_farptr_t</a>&#160;</td>
          <td class="paramname"><em>farptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes a far pointer into another location. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">segment</td><td>where to write the segment </td></tr>
    <tr><td class="paramname">offset</td><td>where to write the offset </td></tr>
    <tr><td class="paramname">farptr</td><td>the far pointer to write </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vm86_8c_source.html#l00118">118</a> of file <a class="el" href="vm86_8c_source.html">vm86.c</a>.</p>

<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__vm86_ga82aed4d420a3b9125d17282a9e27f0cb_icgraph.png" border="0" usemap="#group__vm86_ga82aed4d420a3b9125d17282a9e27f0cb_icgraph" alt=""/></div>
<map name="group__vm86_ga82aed4d420a3b9125d17282a9e27f0cb_icgraph" id="group__vm86_ga82aed4d420a3b9125d17282a9e27f0cb_icgraph">
<area shape="rect" id="node2" href="group__vm86.html#ga4d4693ff0e30f0f617d47282e7ad1c7f" title="Emulates a PUSH instruction. " alt="" coords="209,5,299,31"/>
<area shape="rect" id="node3" href="group__vm86.html#ga6782fcbda03f1415e656d951f764f6b6" title="Monitors a VM86 task by emulating sensitive instructions. " alt="" coords="374,81,480,107"/>
<area shape="rect" id="node6" href="group__vm86.html#ga3e03a7c1532cfd10daa3b44cec6d17b4" title="Emulates a POP instruction. " alt="" coords="212,107,296,132"/>
<area shape="rect" id="node7" href="group__vm86.html#ga3095919424e99ca406a3252e974b86d9" title="Emulates the completion of an instruction. " alt="" coords="181,156,326,181"/>
<area shape="rect" id="node4" href="group__vm86.html#gaf5c9879c84edccf22a667fe2672bf647" title="Handles general protection faults. " alt="" coords="528,81,656,107"/>
<area shape="rect" id="node5" href="group__vm86.html#ga27b2421e58df36b74005f433a4649a54" title="Initializes VM86 mode. " alt="" coords="704,81,782,107"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
